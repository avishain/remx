(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{67:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return l})),a.d(t,"rightToc",(function(){return s})),a.d(t,"default",(function(){return b}));var n=a(2),o=a(6),r=(a(0),a(77)),i={id:"why-remx",title:"Why Remx",sidebar_label:"Why Remx",slug:"/introduction/why-remx"},l={unversionedId:"why-remx",id:"why-remx",isDocsHomePage:!1,title:"Why Remx",description:"When writing a react / react-native project with or without TDD, we have multiple well known and battle-tested choices when it comes to state management:",source:"@site/docs/why-remx.md",slug:"/introduction/why-remx",permalink:"/remx/docs/introduction/why-remx",editUrl:"https://github.com/wix/remx/edit/master/website/docs/why-remx.md",version:"current",sidebar_label:"Why Remx",sidebar:"someSidebar",previous:{title:"Getting Started",permalink:"/remx/docs/introduction/getting-started"},next:{title:"Examples",permalink:"/remx/docs/introduction/examples"}},s=[{value:"What do we really need from a state management library?",id:"what-do-we-really-need-from-a-state-management-library",children:[]},{value:"But what about dispatch? actions? middlewere?",id:"but-what-about-dispatch-actions-middlewere",children:[]},{value:"To conclude",id:"to-conclude",children:[]}],c={rightToc:s};function b(e){var t=e.components,a=Object(o.a)(e,["components"]);return Object(r.b)("wrapper",Object(n.a)({},c,a,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"When writing a react / react-native project with or without TDD, we have multiple well known and battle-tested choices when it comes to state management:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"local component state",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Pros: Easy to implement, zero boilerplate, works out of the box"),Object(r.b)("li",{parentName:"ul"},"Cons: In our opinion not very good in terms of ",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://en.wikipedia.org/wiki/Scalability"}),"scale"),", component becomes a ",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://en.wikipedia.org/wiki/God_object"}),"God Object")," and it's really hard to test."))),Object(r.b)("li",{parentName:"ul"},"redux",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Pros: is a design pattern, scales very well, individual parts can be tested."),Object(r.b)("li",{parentName:"ul"},"Cons: lots of boilerplate, hard to test-drive (TDD), tests tend to be tightly coupled to the redux library, ",Object(r.b)("a",Object(n.a)({parentName:"li"},{href:"https://en.wikipedia.org/wiki/Cohesion_(computer_science)"}),"state has low cohesion"),"."))),Object(r.b)("li",{parentName:"ul"},"mobx",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"Pros: Easy to implement, almost no boilerplate, performant, high cohesion"),Object(r.b)("li",{parentName:"ul"},"Cons: Can be used in lots of different ways, but in our opinion it has a rather complex API due to the number of features it has.")))),Object(r.b)("p",null,"When we look at all these battle-proven solutions, especially when we're trying to build a large-scale project which lots of different people from different teams can work on, we see a need for some combination of the above features."),Object(r.b)("p",null,"Let's try to break down our actual requirements and see if we can build a system to answer those."),Object(r.b)("h3",{id:"what-do-we-really-need-from-a-state-management-library"},"What do we really need from a state management library?"),Object(r.b)("p",null,"For starters, starting to write our business logic by doing TDD does not require any state management at all. In fact, I would argue that it can only hinder. Try this for example: start by writing test-first all features of a JS(node) application with unit tests ",Object(r.b)("em",{parentName:"p"},"without")," any mention of redux. It is really difficult: if all we want to do is, for example, write a unit of logic that does some login flow, with loading state and authentication and error flows, we see that we have little use of any of these libraries."),Object(r.b)("p",null,"We can just test-drive some ",Object(r.b)("inlineCode",{parentName:"p"},"LoginFlow.js")," with regular functions/objects, call those functions from ",Object(r.b)("inlineCode",{parentName:"p"},"LoginFlow.test.js")," and assert on some exported state. That's it. No frameworks needed."),Object(r.b)("p",null,"redux itself is really just an implementation of ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://facebook.github.io/flux/"}),"flux"),". Which itself is a close relative of MVC.\nWe can take this design pattern and use it to build a scalable architecture, we just don't need redux itself here yet as it doesn't provide anything new and just introduces coupling and boilerplate."),Object(r.b)("p",null,"So one thing we do want to enforce is some data-flow architecture. Still, no frameworks required."),Object(r.b)("p",null,"Well, then where does state management come into play?"),Object(r.b)("p",null,"When we want to connect this ",Object(r.b)("inlineCode",{parentName:"p"},"LoginFlow")," into a react view. We want this view to listen to changes and re-render itself according to some presentation logic (which will be test-driven as well)."),Object(r.b)("p",null,"For our example, we can think about some ",Object(r.b)("inlineCode",{parentName:"p"},"LogicComponent.jsx")," that displays the login username and password, any sucess/failure message, and maybe a loading indicator."),Object(r.b)("p",null,"All we need to do is somehow connect those 2 together. "),Object(r.b)("p",null,"We can't really use redux here because it will require us to rewrite everything, and will make our business logic and tests tightly coupled to redux itself."),Object(r.b)("p",null,"We can however use mobx. If we figure out a way to wrap all of our business logic with mobx's ",Object(r.b)("inlineCode",{parentName:"p"},"observables"),", ",Object(r.b)("inlineCode",{parentName:"p"},"actions"),", and our component as ",Object(r.b)("inlineCode",{parentName:"p"},"observer"),", we will achieve our requiremnents."),Object(r.b)("p",null,"But doing that is not as simple as wrapping everything with mobx. One major thing mobx does is impact all objects that it touches, in order to observe on their state. We want to avoid that, where possible, and ",Object(r.b)("a",Object(n.a)({parentName:"p"},{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy"}),"es6 proxies")," allows us to do just that."),Object(r.b)("p",null,"Furthermore, we don't need the large amount of features mobx supports. We need a small subset of the api, and we need to be very explicit about what goes where, to enforce our chosen redux-like data-flow architecture."),Object(r.b)("p",null,"These decisions are what gave birth to remx. A mixed child of mobx implementation of observable state (backed by es6 proxies) with flux/redux design pattern enforcement."),Object(r.b)("h3",{id:"but-what-about-dispatch-actions-middlewere"},"But what about dispatch? actions? middlewere?"),Object(r.b)("p",null,"In general, redux's middlewere is something we want to avoid. Previous experience taught us that adding just 1 middlewere to a redux store can cause serious performance hit, so we recommend not to do that and just call a function explicitly. Otherwise, if we really want, we can create our own global function that wraps any other function with some logic, for example a logging function. This can be done easily without any framework."),Object(r.b)("p",null,"Actions is where we put our imperative business logic, and so we call them by simply invoking them (with arguments if needed).\nActions can be asynchronous, and shouldn't return anything (to enforce uni-directional data flow). We don't need any dispatching function because our stores are just plain old JS objects (that we test separately). So although not a part of the api (there's really nothing special about ",Object(r.b)("inlineCode",{parentName:"p"},"dispatch")," anyway), we encourage the separation of actions and stores for low coupling, and to put action files next to the same use-case store files, for high cohesion."),Object(r.b)("p",null,"Take a look at the example project to see how remx is intended to be used."),Object(r.b)("h3",{id:"to-conclude"},"To conclude"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"remx takes the redux (flux) architecture and enforces it through a short, simple, clean and strict API:",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"state")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"setters")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"getters")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"connect")))),Object(r.b)("li",{parentName:"ul"},"almost zero boilerpate"),Object(r.b)("li",{parentName:"ul"},"zero impact on tests",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"can be added/removed as a plugin"),Object(r.b)("li",{parentName:"ul"},"does not impact any design decisions"))),Object(r.b)("li",{parentName:"ul"},"implemented with mobx, thus benefits from all the performance of",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"memoization"),Object(r.b)("li",{parentName:"ul"},"avoids unnecessary re-renders"))),Object(r.b)("li",{parentName:"ul"},"uses es6 Proxies (where possible)",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"avoids mobx's Observable wrappers which can cause weird bugs and behaviours")))))}b.isMDXComponent=!0},77:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return m}));var n=a(0),o=a.n(n);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var c=o.a.createContext({}),b=function(e){var t=o.a.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=b(e.components);return o.a.createElement(c.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},p=o.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,r=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=b(a),p=n,m=u["".concat(i,".").concat(p)]||u[p]||d[p]||r;return a?o.a.createElement(m,l(l({ref:t},c),{},{components:a})):o.a.createElement(m,l({ref:t},c))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var r=a.length,i=new Array(r);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var c=2;c<r;c++)i[c]=a[c];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,a)}p.displayName="MDXCreateElement"}}]);